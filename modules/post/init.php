<?php namespace NextFeed\Modules\Post;defined('ABSPATH')||exit;class Init{private static $instance;public $cpt;private static $action='nx_feed';public static function _get_url(){return \NextFeed\Plugin::modules_url().'post/';}public static function _get_dir(){return \NextFeed\Plugin::modules_dir().'post/';}public static function _version(){return \NextFeed\Plugin::version();}public function _init(){add_action('wp_enqueue_scripts',[$this,'_load_script']);add_action('admin_enqueue_scripts',[$this,'_load_script']);add_action('wp_enqueue_scripts',[$this,'_public_scripts']);if(current_user_can('manage_options')){$this->cpt=new Cpt();Cpt::instance()->__init();Action::instance()->__init();Hooks::instance()->__init();Rest::instance()->__init();add_action('admin_enqueue_scripts',[$this,'_admin_scripts']);add_filter('post_row_actions',[$this,'_row_actions'],99,2);add_filter('page_row_actions',[$this,'_row_actions'],99,2);}Controller\Init::instance()->_init();}public function _load_script(){wp_register_style('nextfeed-modules_post',self::_get_url().'assets/css/post.css',false,self::_version());wp_register_script('nextfeed-modules_post',self::_get_url().'assets/js/post.js',['jquery','nextfeed-modal-js'],self::_version(),true);}public function _admin_scripts(){$screen=get_current_screen();if(in_array($screen->id,['edit-nextfeeds','nextfeeds'])){wp_enqueue_style('nextfeed-modules_post');wp_enqueue_script('nextfeed-modules_post');wp_localize_script('nextfeed-modules_post','nextfeed',array('siteurl'=>get_option('siteurl'),'nonce'=>wp_create_nonce('wp_rest'),'resturl'=>get_rest_url(),'admin_url'=>admin_url('post.php')));}}public function _public_scripts(){}public static function get_url($post_id,$ref=''){return wp_nonce_url(add_query_arg(['post'=>$post_id,'action'=>'edit',],admin_url('post.php')),self::$action);}public function _row_actions($actions,$post){$checkEditor=get_post_meta($post->ID,'_elementor_edit_mode',true);if($post->post_type==$this->cpt->get_name()&&!$checkEditor){$actions[self::$action]=sprintf('<a href="%1$s" title="%2$s"><span class="screen-reader-text">%2$s</span>%3$s</a>',esc_url(self::get_url($post->ID)),sprintf(esc_attr__('Edit - %s','next-feed'),esc_attr($post->post_title)),esc_html__('Edit with Gutenberg','next-feed'));}return $actions;}public static function instance(){if(!self::$instance){self::$instance=new self();}return self::$instance;}}